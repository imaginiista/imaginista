<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Aldeia das √Åguas ‚Äî Roteiro (Op√ß√£o C)</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    /* =========================
       VARS & RESET
    ==========================*/
    :root{
      --bg:#021324;
      --card:#062a36;
      --accent:#00b8d4;
      --accent2:#007a8a;
      --muted:rgba(255,255,255,0.92);
      --glass:rgba(255,255,255,0.03);
      --max-width:980px;
      --ease: cubic-bezier(.2,.9,.3,1);
      --shadow-1: 0 10px 30px rgba(0,0,0,0.45);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family:Inter,system-ui,Arial,sans-serif;
      background: linear-gradient(180deg,var(--bg) 0%, #04202a 60%);
      color:var(--muted);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding-bottom:60px;
      overflow-y:auto;
      -webkit-tap-highlight-color: transparent;
    }

    /* Canvas background occupies full viewport under everything */
    #bg-canvas{
      position:fixed; inset:0; width:100%; height:100%;
      z-index:0; pointer-events:none; display:block;
      will-change:transform,opacity;
    }

    /* rest is same layout as your working template */
    .bg-layer { position: fixed; inset: 0; pointer-events: none; z-index:1; }

    .refraction-wrap{
      position: absolute; inset: 0; z-index:1; overflow:hidden; opacity:0.34;
      mix-blend-mode: screen; filter: blur(0.6px);
    }
    .light-overlay{
      position:absolute; inset:0; background:
        radial-gradient(600px 200px at 10% 10%, rgba(0,200,220,0.06), transparent 12%),
        radial-gradient(800px 260px at 90% 20%, rgba(0,140,180,0.04), transparent 14%);
      z-index:2; pointer-events:none; opacity:0.92;
      transform: translateZ(0);
    }
    .bokeh-wrap{ position:absolute; inset:0; z-index:1; pointer-events:none; overflow:hidden; opacity:0.12 }
    .bokeh { position:absolute; border-radius:50%; filter: blur(18px); opacity:0.7; transform: translate3d(0,0,0) scale(1.1); }

    .top-waves{
      position:fixed; left:0; right:0; top:0; height:140px; pointer-events:none; z-index:2;
      display:flex; align-items:flex-start; justify-content:center; overflow:hidden;
    }
    .top-waves svg{ width:140%; height:160px; display:block; transform:translateY(-20%); opacity:0.98; will-change:transform; }

    .wrap{ max-width:var(--max-width); margin:24px auto; padding:16px; position:relative; z-index:3 }

    header{ display:flex; align-items:center; gap:12px; margin-bottom:14px }
    .logo{ width:56px; height:56px; border-radius:10px; object-fit:contain; display:block; position:relative; overflow:hidden }
    .logo img{ width:100%; height:100%; display:block; filter: drop-shadow(0 6px 18px rgba(0,0,0,0.4)); }
    .logo canvas.shine{ position:absolute; inset:0; pointer-events:none; z-index:4 }

    .title h1{ font-size:18px; color:#eafcff; margin-bottom:4px }
    .title p{ font-size:13px; color:rgba(234,252,255,0.8) }

    .hero{ background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); padding:14px; border-radius:12px; border:1px solid rgba(255,255,255,0.03); box-shadow:var(--shadow-1); display:flex; flex-direction:column; gap:8px; position:relative; overflow:hidden; transform-origin:center; }
    .badge{ background: rgba(0,0,0,0.25); padding:8px 10px; border-radius:999px; font-weight:700; color:var(--accent); display:inline-block }

    .grid{ display:grid; grid-template-columns:1fr; gap:12px; margin-top:12px }
    @media(min-width:820px){ .grid{ grid-template-columns:2fr 1fr } }

    .card{ background:var(--card); padding:14px; border-radius:12px; border:1px solid rgba(255,255,255,0.03); box-shadow:var(--shadow-1); transition: box-shadow 300ms var(--ease), transform 300ms var(--ease), opacity 300ms var(--ease) }
    .card h3{ color:#eafcff; margin-bottom:10px }
    .muted{ color:rgba(255,255,255,0.7); font-size:13px }

    .costs{ display:flex; flex-direction:column; gap:8px }
    .person{ display:flex; align-items:center; gap:12px; padding:10px; background:linear-gradient(90deg, rgba(255,255,255,0.02), transparent); border-radius:10px; transition: transform 220ms var(--ease) }
    .person:hover{ transform:translateY(-6px) }
    .person .name{ font-weight:700; color:#e6fbff }
    .person .total{ margin-left:auto; font-weight:800; color:var(--accent) }

    .items-list{ display:flex; flex-direction:column; gap:8px }
    .item-row{ display:flex; align-items:center; justify-content:space-between; padding:10px; border-radius:10px; background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.02)); border:1px solid rgba(255,255,255,0.02); transition: transform 200ms var(--ease), box-shadow 220ms var(--ease) }
    .item-row:hover{ transform:translateY(-6px); box-shadow:0 18px 40px rgba(0,0,0,0.45) }
    .left{ display:flex; align-items:center; gap:10px }
    .qty{ background:rgba(0,0,0,0.25); padding:6px 8px; border-radius:8px; font-weight:800; color:var(--accent) }
    .price{ font-weight:800; color:var(--accent2) }

    .map{ position:relative; border-radius:10px; overflow:hidden; transform-origin:center; transition: transform 300ms var(--ease) }
    .map img{ width:100%; height:auto; display:block; border-radius:10px; cursor:pointer; transition: transform 320ms var(--ease) }
    .map.zoomed img{ transform: scale(1.08) }
    .map-actions{ display:flex; gap:8px; margin-top:8px }

    .btn{ flex:1; padding:10px; border-radius:10px; border:none; background:linear-gradient(90deg,var(--accent),var(--accent2)); color:#012; font-weight:800; cursor:pointer; position:relative; overflow:hidden; outline:none }
    .btn.ghost{ background:transparent; border:1px solid rgba(255,255,255,0.06); color:var(--muted) }
    .btn:active{ transform:translateY(2px) }
    .btn::after{ content:''; position:absolute; left:-60%; top:0; width:40%; height:100%; background: linear-gradient(90deg, rgba(255,255,255,0.15), rgba(255,255,255,0.25), rgba(255,255,255,0.15)); transform:skewX(-20deg); opacity:0; transition: opacity 300ms, left 700ms; }
    .btn.shine::after{ left:120%; opacity:1; transition:left 900ms cubic-bezier(.2,.9,.3,1) }
    .btn.pulse{ animation: pulseBtn 900ms ease-in-out 1 }
    @keyframes pulseBtn{ 0%{transform:scale(1)} 50%{transform:scale(1.03)} 100%{transform:scale(1)} }

    .checklist{ display:flex; flex-direction:column; gap:8px }
    .checkline{ display:flex; align-items:center; gap:10px; padding:8px; border-radius:10px; background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.02)); transition: background 220ms var(--ease) }
    .checkline input[type='checkbox']{ transform:scale(1.1); margin-right:8px; accent-color:var(--accent) }
    .checkline.checked{ background:linear-gradient(90deg, rgba(0,184,212,0.08), rgba(0,122,138,0.04)); }

    .add-inline{ display:flex; gap:8px; margin-top:8px }
    .add-inline input{ flex:1; padding:10px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:transparent; color:var(--muted) }
    .add-inline button{ padding:10px; border-radius:10px; border:none; background:var(--accent); font-weight:800; color:#012; cursor:pointer; transition: transform 180ms var(--ease) }

    /* in-view animation */
    .fadeInUp{ opacity:0; transform:translateY(18px); transition: opacity 520ms var(--ease), transform 520ms var(--ease) }
    .inview{ opacity:1; transform:none }

    footer{ margin-top:20px; text-align:center; color:rgba(255,255,255,0.5); font-size:13px }

    /* small touch feedback */
    .touch-feedback{ transition:transform 120ms; will-change:transform }
    .touch-feedback:active{ transform:scale(0.98) }

    @media (prefers-reduced-motion: reduce) {
      #bg-canvas { display:none; } /* if user wants reduced motion, remove canvas animation */
      .refraction-wrap, .particles, .bokeh-wrap, .top-waves svg { animation: none !important; transition: none !important; }
      .fadeInUp, .inview { transition: none !important; opacity:1 !important; transform:none !important; }
    }

  </style>
</head>
<body>
  <!-- Background canvas sits behind the visual layers -->
  <canvas id="bg-canvas" aria-hidden="true"></canvas>

  <div class="bg-layer" aria-hidden="true">
    <div class="refraction-wrap" aria-hidden="true">
      <svg width="100%" height="100%" viewBox="0 0 1400 900" preserveAspectRatio="xMidYMid slice" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <filter id="rfr" x="0" y="0" width="100%" height="100%">
            <feTurbulence id="turb" type="fractalNoise" baseFrequency="0.006 0.018" numOctaves="2" seed="3" stitchTiles="stitch" result="noise" />
            <feDisplacementMap in="SourceGraphic" in2="noise" scale="18" xChannelSelector="R" yChannelSelector="G" />
          </filter>
          <linearGradient id="gradRef" x1="0" x2="1">
            <stop offset="0" stop-color="#003d46" stop-opacity="0.16"/>
            <stop offset="0.5" stop-color="#004f61" stop-opacity="0.10"/>
            <stop offset="1" stop-color="#002f36" stop-opacity="0.16"/>
          </linearGradient>
        </defs>
        <rect x="0" y="0" width="100%" height="100%" fill="url(#gradRef)" filter="url(#rfr)"></rect>
      </svg>
    </div>

    <div class="light-overlay" aria-hidden="true"></div>

    <div class="bokeh-wrap" aria-hidden="true">
      <div class="bokeh" style="width:320px;height:320px;left:6%;top:6%;background:rgba(0,220,235,0.08)"></div>
      <div class="bokeh" style="width:220px;height:220px;left:78%;top:18%;background:rgba(0,160,200,0.06)"></div>
      <div class="bokeh" style="width:180px;height:180px;left:44%;top:62%;background:rgba(0,200,220,0.06)"></div>
    </div>

    <div class="top-waves" aria-hidden="true">
      <svg viewBox="0 0 1200 160" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="gw" x1="0" x2="1">
            <stop offset="0" stop-color="#00c2d1" stop-opacity="0.08"/>
            <stop offset="1" stop-color="#007aa3" stop-opacity="0.06"/>
          </linearGradient>
        </defs>
        <path id="wavePath" d="M0 100 C200 40 400 140 600 100 C800 60 1000 120 1200 100 L1200 160 L0 160 Z" fill="url(#gw)"></path>
      </svg>
    </div>
  </div>

  <!-- APP CONTENT (your layout untouched) -->
  <div class="wrap">
    <header>
      <div class="logo" aria-hidden="true">
        <img src="logo.png" alt="Aldeia das √Åguas">
        <canvas class="shine" width="56" height="56" aria-hidden="true"></canvas>
      </div>
      <div class="title">
        <h1>Aldeia das √Åguas</h1>
        <p class="muted">Guia do passeio ‚Ä¢ 21 de novembro de 2025 ‚Äî Chegar 09:20</p>
      </div>
    </header>

    <section class="hero card fadeInUp" id="hero-card" data-parallax="0.04">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div class="badge" id="hero-badge" data-parallax="0.08">Ponto de encontro: Esta√ß√£o Sant√≠ssimo üöá</div>
          <div class="muted" style="margin-top:6px">Av. de Santa Cruz, 9591 (ETERJ üè´) ‚Äî Embarque e sa√≠da √†s <strong>06:10</strong></div>
        </div>
        <div style="text-align:right">
          <div class="muted">Hor√°rio do parque</div>
          <div style="font-weight:900;color:var(--accent);font-size:16px">09:30 ‚Äî 17:00</div>
        </div>
      </div>

      <div style="display:flex;gap:10px;align-items:center;margin-top:12px">
        <div style="flex:1">
          <div class="muted">Total do grupo</div>
          <div style="font-weight:900;font-size:20px;color:var(--accent);">R$ 753,50</div>
        </div>
        <div style="display:flex;flex-direction:column;gap:8px;width:180px">
          <button class="btn touch-feedback" id="open-checklist">Abrir checklist</button>
          <button class="btn ghost touch-feedback" id="open-map">Ir para mapa</button>
        </div>
      </div>
    </section>

    <div class="grid">
      <div>
        <section class="card fadeInUp" id="costs-card" data-parallax="0.02">
          <h3>Valores por pessoa</h3>
          <div class="costs" id="costs">
            <div class="person"><div class="name">Robson</div><div class="total">R$ 140,10</div></div>
            <div class="person"><div class="name">Taisa</div><div class="total">R$ 178,10</div></div>
            <div class="person"><div class="name">√çtalo</div><div class="total">R$ 155,10</div></div>
            <div class="person"><div class="name">Matheus</div><div class="total">R$ 140,10</div></div>
            <div class="person"><div class="name">Renata</div><div class="total">R$ 140,10</div></div>
          </div>
        </section>

        <section class="card fadeInUp" id="items-card" data-parallax="0.03">
          <h3>Itens adquiridos</h3>
          <div class="items-list" id="items-list">
            <div class="item-row"><div class="left"><div class="qty">1x</div><div>Oca Restaurante</div></div><div class="price">R$ 49,90</div></div>
            <div class="item-row"><div class="left"><div class="qty">1x</div><div>Ingresso</div></div><div class="price">R$ 77,00</div></div>
            <div class="item-row"><div class="left"><div class="qty">3x</div><div>Arm√°rios</div></div><div class="price">R$ 13,20</div></div>
            <div class="item-row"><div class="left"><div class="qty">1x</div><div>Estacionamento</div></div><div class="price">R$ 23,00</div></div>
            <div class="item-row"><div class="left"><div class="qty">1x</div><div>Caipirinha</div></div><div class="price">R$ 15,00</div></div>
          </div>
        </section>

        <section class="card fadeInUp" id="logistica-card">
          <h3>Log√≠stica aprimorada</h3>
          <p class="muted">Ponto de encontro: <strong>Esta√ß√£o Sant√≠ssimo (lado da ETERJ)</strong></p>
          <div style="display:flex;gap:8px;margin-top:8px;flex-wrap:wrap">
            <div style="flex:1;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.02));padding:12px;border-radius:10px">
              <div class="muted">Viagem estimada</div>
              <div style="font-weight:900">3h00</div>
            </div>
            <div style="flex:1;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.02));padding:12px;border-radius:10px">
              <div class="muted">Chegar √†s</div>
              <div style="font-weight:900">09:20</div>
            </div>
            <div style="flex:1;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.02));padding:12px;border-radius:10px">
              <div class="muted">Sa√≠da sugerida</div>
              <div style="font-weight:900">06:10</div>
            </div>
          </div>
          <p class="muted" style="margin-top:10px">Recomenda-se sair com 10‚Äì15 minutos de margem extra para imprevistos. Confirme bilhetes e documentos antes do embarque.</p>
        </section>
      </div>

      <aside>
        <section class="card map fadeInUp" id="map-card" data-parallax="0.05">
          <h3>Mapa do Parque (clique para ampliar / toque para dar zoom)</h3>
          <a href="https://www.aldeiadasaguasresort.com.br/wp-content/uploads/2025/08/Mapa-do-Parque-Atualizado-em-22-08-2025.png" target="_blank" rel="noopener">
            <img src="mapa.png" alt="Mapa Aldeia das √Åguas" id="map-image" />
          </a>
          <div class="map-actions">
            <button class="btn touch-feedback" id="open-waze">Abrir no Waze</button>
            <button class="btn ghost touch-feedback" id="open-google">Abrir no Google Maps</button>
          </div>
        </section>

        <section class="card fadeInUp" id="checklist-card">
          <h3>Checklist & Compartilhar</h3>
          <div class="checklist" id="checklist">
            <label class="checkline"><input type="checkbox" data-key="documento"> Documento | Ingresso</label>
            <label class="checkline"><input type="checkbox" data-key="dinheiro"> Dinheiro | Cart√£o</label>
            <label class="checkline"><input type="checkbox" data-key="protetor"> Protetor solar</label>
            <label class="checkline"><input type="checkbox" data-key="labial"> Protetor labial com FPS</label>
            <label class="checkline"><input type="checkbox" data-key="repelente"> Repelente</label>
            <label class="checkline"><input type="checkbox" data-key="roupa-banho"> Roupa de banho</label>
            <label class="checkline"><input type="checkbox" data-key="roupas-leves"> Roupas leves e confort√°veis</label>
            <label class="checkline"><input type="checkbox" data-key="saida-praia"> Sa√≠da de praia / canga</label>
            <label class="checkline"><input type="checkbox" data-key="chinelo"> Chinelo ou sand√°lia</label>
            <label class="checkline"><input type="checkbox" data-key="len√ßos"> Len√ßos umedecidos</label>
            <label class="checkline"><input type="checkbox" data-key="capa"> Capa √† prova d‚Äô√°gua</label>
            <label class="checkline"><input type="checkbox" data-key="cabo"> Cabo de carregamento</label>
            <label class="checkline"><input type="checkbox" data-key="garrafa"> Garrafinha de √°gua reutiliz√°vel</label>
            <label class="checkline"><input type="checkbox" data-key="mochila"> Mochila leve</label>
            <label class="checkline"><input type="checkbox" data-key="bon√©"> Bon√© ou chap√©u</label>
            <label class="checkline"><input type="checkbox" data-key="toalha"> Toalha</label>

            <div class="add-inline">
              <input type="text" id="new-item" placeholder="Adicionar item pessoal (ex: protetor labial)" />
              <button id="add-btn" class="touch-feedback">Adicionar</button>
            </div>

            <div style="display:flex;gap:8px;margin-top:10px">
              <button class="btn" id="share-marked">Compartilhar itens marcados (WhatsApp)</button>
              <button class="btn ghost" id="share-all">Compartilhar tudo (WhatsApp)</button>
            </div>

            <div style="margin-top:8px" class="muted">As suas marcas s√£o salvas localmente no seu aparelho (capaz de ser recuperado na pr√≥xima visita).</div>
          </div>
        </section>
      </aside>
    </div>

    <footer>
      Endere√ßo: BR 393, KM 270 ‚Äî Dor√¢ndia, Barra do Pira√≠ ‚Äî RJ ‚Ä¢ CEP 27160-000
    </footer>
  </div>

  <!-- SCRIPTS -->
  <script>
    /* -------------------------
       Helpers & reduced-motion
       ------------------------- */
    const $ = sel => document.querySelector(sel);
    const $$ = sel => Array.from(document.querySelectorAll(sel));
    const byId = id => document.getElementById(id);
    const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    /* -------------------------
       Background Canvas (efficient)
       - draws soft radial gradient + gently rising bubbles
       - frame-limited (target ~45fps) and uses devicePixelRatio scaled canvas
       ------------------------- */
    (function backgroundCanvas(){
      if(prefersReduced) return; // respect user
      const canvas = byId('bg-canvas');
      if(!canvas) return;
      const ctx = canvas.getContext('2d', { alpha: true });
      let w = 0, h = 0, DPR = Math.max(1, window.devicePixelRatio || 1);

      function resize(){
        w = window.innerWidth;
        h = window.innerHeight;
        canvas.style.width = w + 'px';
        canvas.style.height = h + 'px';
        canvas.width = Math.round(w * DPR);
        canvas.height = Math.round(h * DPR);
        ctx.setTransform(DPR, 0, 0, DPR, 0, 0);
      }
      resize();
      window.addEventListener('resize', resize, {passive:true});

      // particles (bubbles) config
      const COUNT = Math.max(10, Math.round(Math.min(40, (w*h)/80000))); // adaptive but capped
      const bubbles = [];
      for(let i=0;i<COUNT;i++){
        const radius = (6 + Math.random()*28);
        bubbles.push({
          x: Math.random()*w,
          y: h + Math.random()*h*0.6, // start off-screen bottom
          radius,
          speed: 6 + Math.random()*22, // px per second
          drift: (-12 + Math.random()*24),
          alpha: 0.02 + Math.random()*0.12,
          phase: Math.random()*Math.PI*2,
          swayAmp: 6 + Math.random()*12
        });
      }

      // background gradient parameters (soft)
      function drawBackground(){
        // clear with subtle transparent fill to create trailing softness
        ctx.clearRect(0,0,w,h);

        // radial soft light at top-left and top-right
        const g1 = ctx.createRadialGradient(w*0.12, h*0.12, 0, w*0.12, h*0.12, Math.max(w,h)*0.6);
        g1.addColorStop(0, 'rgba(0,200,220,0.06)');
        g1.addColorStop(1, 'rgba(0,200,220,0)');
        ctx.fillStyle = g1;
        ctx.fillRect(0,0,w,h);

        const g2 = ctx.createRadialGradient(w*0.9, h*0.18, 0, w*0.9, h*0.18, Math.max(w,h)*0.6);
        g2.addColorStop(0, 'rgba(0,140,180,0.04)');
        g2.addColorStop(1, 'rgba(0,140,180,0)');
        ctx.fillStyle = g2;
        ctx.fillRect(0,0,w,h);

        // subtle overlay gradient to match page
        const gg = ctx.createLinearGradient(0,0,0,h);
        gg.addColorStop(0, 'rgba(2,19,36,0.32)');
        gg.addColorStop(1, 'rgba(4,32,42,0.6)');
        ctx.fillStyle = gg;
        ctx.fillRect(0,0,w,h);
      }

      // animation loop with framerate limiting
      let lastTime = 0;
      const targetFPS = 45;
      const frameDuration = 1000 / targetFPS;

      function step(now){
        if(!lastTime) lastTime = now;
        const dt = now - lastTime;
        if (dt >= frameDuration) {
          lastTime = now - (dt % frameDuration);
          // draw
          drawBackground();
          // draw bubbles
          for(let i=0;i<bubbles.length;i++){
            const b = bubbles[i];
            // move up relative to speed
            b.y -= b.speed * (dt/1000);
            b.x += Math.sin((now/1000) + b.phase) * (b.swayAmp * 0.02) + b.drift * 0.002 * (dt/16);
            // pulse alpha slightly
            const puls = 0.4 + Math.sin((now/1000) + b.phase)*0.6;
            ctx.beginPath();
            const grad = ctx.createRadialGradient(b.x - b.radius*0.3, b.y - b.radius*0.3, b.radius*0.05, b.x, b.y, b.radius);
            grad.addColorStop(0, `rgba(255,255,255,${(b.alpha * 1.1 * Math.max(0.35,puls)).toFixed(3)})`);
            grad.addColorStop(0.6, `rgba(255,255,255,${(b.alpha * 0.55).toFixed(3)})`);
            grad.addColorStop(1, `rgba(255,255,255,0)`);
            ctx.fillStyle = grad;
            ctx.arc(b.x, b.y, b.radius, 0, Math.PI*2);
            ctx.fill();

            // recycle when off top or far side
            if(b.y + b.radius < -50 || b.x < -100 || b.x > w + 100){
              b.x = Math.random()*w;
              b.y = h + (10 + Math.random()*200);
              b.speed = 6 + Math.random()*22;
              b.drift = (-12 + Math.random()*24);
            }
          }
        }
        requestAnimationFrame(step);
      }
      requestAnimationFrame(step);
    })();

    /* -------------------------
       Wave Path Morph (lightweight)
       - updates path control points via requestAnimationFrame
       ------------------------- */
    (function animateWavePath(){
      if(prefersReduced) return;
      const path = document.getElementById('wavePath');
      if(!path) return;
      let t = 0;
      function frame(){
        t += 0.0018;
        const a = 40 + Math.sin(t*2.05)*18;
        const b = 120 + Math.cos(t*1.65)*12;
        const c = 80 + Math.sin(t*1.1)*10;
        const d = 140 + Math.cos(t*0.9)*8;
        const dAttr = `M0 100 C200 ${a} 400 ${b} 600 100 C800 ${c} 1000 ${d} 1200 100 L1200 160 L0 160 Z`;
        path.setAttribute('d', dAttr);
        requestAnimationFrame(frame);
      }
      requestAnimationFrame(frame);
    })();

    /* -------------------------
       feTurbulence animation (cheap)
       - gently oscillates baseFrequency on a low interval
       ------------------------- */
    (function animateTurbulence(){
      if(prefersReduced) return;
      const turb = document.querySelector('feTurbulence#turb');
      if(!turb) return;
      let t = 0;
      setInterval(()=>{
        t += 0.04;
        const f1 = 0.005 + Math.abs(Math.sin(t*0.6)) * 0.006;
        const f2 = 0.016 + Math.abs(Math.cos(t*0.9)) * 0.010;
        try { turb.setAttribute('baseFrequency', `${f1.toFixed(5)} ${f2.toFixed(5)}`); } catch(e) {}
      }, 280); // slower interval to save CPU
    })();

    /* -------------------------
       Logo shine (canvas) - single small canvas
       ------------------------- */
    (function logoShine(){
      const logoWrap = document.querySelector('.logo');
      if(!logoWrap) return;
      const canvas = logoWrap.querySelector('.shine');
      if(!canvas) return;
      if(prefersReduced) { canvas.style.display = 'none'; return; }
      const ctx = canvas.getContext('2d');
      function resize(){
        const wCSS = logoWrap.clientWidth;
        const hCSS = logoWrap.clientHeight;
        canvas.width = Math.round(wCSS * devicePixelRatio);
        canvas.height = Math.round(hCSS * devicePixelRatio);
        canvas.style.width = wCSS + 'px';
        canvas.style.height = hCSS + 'px';
        ctx.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0);
      }
      resize();
      window.addEventListener('resize', resize, {passive:true});
      let t = 0;
      function draw(){
        t += 0.02;
        ctx.clearRect(0,0,canvas.width,canvas.height);
        const w = canvas.width / devicePixelRatio, h = canvas.height / devicePixelRatio;
        const grad = ctx.createLinearGradient(-w + Math.sin(t)*w,0, w + Math.cos(t)*w,0);
        grad.addColorStop(0,'rgba(255,255,255,0)');
        grad.addColorStop(0.45,'rgba(255,255,255,0.06)');
        grad.addColorStop(0.5,'rgba(255,255,255,0.14)');
        grad.addColorStop(0.55,'rgba(255,255,255,0.04)');
        grad.addColorStop(1,'rgba(255,255,255,0)');
        ctx.fillStyle = grad;
        ctx.fillRect(0,0,w,h);
        requestAnimationFrame(draw);
      }
      requestAnimationFrame(draw);
    })();

    /* -------------------------
       Small UX scripts: parallax, checklist, map zoom, sharing...
       (kept minimal and efficient; unchanged logic from your base)
       ------------------------- */
    (function baseUX(){
      const REDUCE = prefersReduced;

      const $ = s => document.querySelector(s);
      const $$ = s => Array.from(document.querySelectorAll(s));
      const byId = id => document.getElementById(id);
      function safe(id, evt, fn){ const el = byId(id); if(!el){ console.warn('missing', id); return; } el.addEventListener(evt, fn); }

      // parallax small effect
      if(!prefersReduced){
        const parEls = document.querySelectorAll('[data-parallax]');
        function onScroll(){
          const sc = window.scrollY;
          parEls.forEach(el=>{
            const v = parseFloat(el.dataset.parallax || 0.02);
            el.style.transform = `translateY(${-(sc * v)}px)`;
            const rect = el.getBoundingClientRect();
            const factor = Math.max(0, Math.min(1, 1 - Math.abs(rect.top) / (window.innerHeight*0.8)));
            el.style.opacity = 0.7 + 0.3*factor;
            el.style.boxShadow = `0 ${8 + (1-factor)*12}px ${20 + (1-factor)*30}px rgba(0,0,0,${0.35+(1-factor)*0.2})`;
          });
        }
        window.addEventListener('scroll', onScroll, {passive:true});
        onScroll();
      }

      // map zoom
      (function mapZoom(){
        const mapWrap = byId('map-card');
        const mapImg = byId('map-image');
        if(!mapWrap || !mapImg) return;
        let zoomed = false;
        mapImg.addEventListener('click', (e)=>{
          if(prefersReduced) return;
          // allow click-through to link if user ctrl/cmd-click or long-press: only prevent default for plain click
          if(e.metaKey || e.ctrlKey) return;
          e.preventDefault();
          zoomed = !zoomed;
          if(zoomed) mapWrap.classList.add('zoomed');
          else mapWrap.classList.remove('zoomed');
        });
      })();

      // basic checklist persistence (compact & robust)
      (function checklist(){
        const KEY = 'aldeia_check_v5';
        function save(){
          const obj = {};
          document.querySelectorAll('#checklist .checkline').forEach(lbl=>{
            const cb = lbl.querySelector('input[type=checkbox]');
            if(!cb) return;
            const k = cb.dataset.key || lbl.innerText.trim();
            obj[k] = !!cb.checked;
          });
          // extras
          const extras = [];
          document.querySelectorAll('#checklist .extra-item').forEach(e => extras.push({text: e.dataset.text, checked: e.querySelector('input').checked}));
          obj._extra = extras;
          localStorage.setItem(KEY, JSON.stringify(obj));
        }
        function load(){
          try{
            const raw = localStorage.getItem(KEY);
            if(!raw) return;
            const data = JSON.parse(raw);
            document.querySelectorAll('#checklist .checkline').forEach(lbl=>{
              const cb = lbl.querySelector('input[type=checkbox]');
              if(!cb) return;
              const k = cb.dataset.key || lbl.innerText.trim();
              if(data[k]) { cb.checked = true; lbl.classList.add('checked'); }
            });
            if(Array.isArray(data._extra)){
              const ref = document.querySelector('#checklist .add-inline');
              data._extra.forEach(it => {
                const lab = document.createElement('label');
                lab.className = 'checkline extra-item';
                lab.dataset.text = it.text;
                lab.innerHTML = `<input type="checkbox" ${it.checked ? 'checked' : ''} /> ${it.text}`;
                ref.parentNode.insertBefore(lab, ref);
              });
            }
          }catch(e){ console.warn(e); }
        }
        // add new
        const addBtn = byId('add-btn');
        if(addBtn){
          addBtn.addEventListener('click', ()=>{
            const input = byId('new-item');
            if(!input) return;
            const v = input.value.trim();
            if(!v) return;
            const lab = document.createElement('label');
            lab.className = 'checkline extra-item';
            lab.dataset.text = v;
            lab.innerHTML = `<input type="checkbox" checked /> ${v}`;
            const ref = document.querySelector('#checklist .add-inline');
            ref.parentNode.insertBefore(lab, ref);
            input.value = '';
            save();
          });
        }
        // listen to changes
        document.addEventListener('change', (e)=>{
          if(e.target && e.target.matches('#checklist input[type="checkbox"]')) save();
        }, {passive:true});
        load();
      })();

      // sharing (WhatsApp)
      (function sharing(){
        function collect(onlyMarked){
          const lines = [];
          document.querySelectorAll('#checklist .checkline').forEach(lbl=>{
            const cb = lbl.querySelector('input[type=checkbox]');
            const text = lbl.innerText.trim();
            if(onlyMarked){
              if(cb && cb.checked) lines.push('‚úÖ ' + text);
            } else {
              lines.push((cb && cb.checked ? '‚úÖ ' : '[ ] ') + text);
            }
          });
          return lines;
        }
        const header = `Aldeia das √Åguas ‚Äî Checklist e log√≠stica\nPonto: Esta√ß√£o Sant√≠ssimo (Av. de Santa Cruz, 9591)\nSa√≠da sugerida: 06:10 (chegar 09:20)\n\n`;
        const openWA = url => window.open(url, '_blank');

        const shareMarked = byId('share-marked');
        if(shareMarked) shareMarked.addEventListener('click', ()=>{
          const lines = collect(true);
          if(lines.length === 0) { alert('Nenhum item marcado.'); return; }
          openWA(`https://api.whatsapp.com/send?text=${encodeURIComponent(header + lines.join('\n'))}`);
        });
        const shareAll = byId('share-all');
        if(shareAll) shareAll.addEventListener('click', ()=>{
          const lines = collect(false);
          openWA(`https://api.whatsapp.com/send?text=${encodeURIComponent(header + lines.join('\n'))}`);
        });
      })();

      // button hover/press ripple (light)
      (function ripple(){
        document.querySelectorAll('.btn').forEach(btn=>{
          btn.addEventListener('pointerdown', (e)=>{
            if(prefersReduced) return;
            const r = document.createElement('span');
            const rect = btn.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height) * 1.2;
            r.style.position = 'absolute';
            r.style.left = (e.clientX - rect.left - size/2) + 'px';
            r.style.top = (e.clientY - rect.top - size/2) + 'px';
            r.style.width = r.style.height = size + 'px';
            r.style.borderRadius = '50%';
            r.style.background = 'rgba(255,255,255,0.06)';
            r.style.pointerEvents = 'none';
            r.style.transform = 'scale(0)';
            r.style.transition = 'transform 420ms ease, opacity 420ms';
            btn.appendChild(r);
            requestAnimationFrame(()=> r.style.transform = 'scale(1)');
            setTimeout(()=>{ r.style.opacity = '0'; setTimeout(()=> r.remove(), 450); }, 420);
          });
        });
      })();

      // initial fade-in
      document.addEventListener('DOMContentLoaded', ()=>{
        $$('.fadeInUp').slice(0,6).forEach((el, i)=> setTimeout(()=> el.classList.add('inview'), i*80));
      });
    })();

  </script>
</body>
</html>
